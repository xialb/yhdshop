"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var ChangeNotice=function(){function e(){_classCallCheck(this,e),this.list=document.querySelector(".hd_topbarhome_list"),this.index=1,this.init()}return _createClass(e,[{key:"init",value:function(){var e=this,t=this.list.children[0].cloneNode(!0);this.list.appendChild(t),clearInterval(this.list.timer),this.list.timer=setInterval(function(){$(e.list).animate({top:30*-e.index},300,function(){e.index++,e.index==e.list.children.length&&(e.index=1,e.list.style.top="0")})},2e3)}}]),e}();new ChangeNotice;var LoadGoods=function(){function e(){_classCallCheck(this,e),this.box=document.querySelector(".cart_show .goods_list"),this.url="../lib/interface/showlist.php",this.init()}return _createClass(e,[{key:"init",value:function(){var a=this,i="";ajaxGet(this.url,function(e){if(1==JSON.parse(e).code){a.json=JSON.parse(e).data;for(var t=0;t<a.json.length;t++){var n=Number(a.json[t].product_price*a.json[t].product_num).toFixed(2);i+='<div class="cart_goods clear_fix" data-goodsId="'.concat(a.json[t].product_id,'">\n                                <a href="javascript:;" class="pro_select_none">\n                                    <span><img src="../images/selectimg.png" alt=""></span>\n                                </a>\n                                <a href="javascript:;" class="cart_goods_img">\n                                    <img src="').concat(a.json[t].product_img,'" alt="">\n                                </a>\n                                <a href="javascript:;" class="cart_goods_name">\n                                    ').concat(a.json[t].product_name,' \n                                </a>\n                                <span class="cart_goods_price">').concat(a.json[t].product_price,'</span>\n                                <div class="cart_goods_num">\n                                    <a href="javascript:;" class="reduce_goods_num">-</a>\n                                    <input type="text" readonly="readonly" value="').concat(a.json[t].product_num,'">\n                                    <a href="javascript:;" class="add_goods_num">+</a>\n                                </div>\n                                <span class="cart_goods_pricetotal">').concat(n,'</span>\n                                <a href="javascript:;" class="cart_goods_del">\n                                    <img src="../images/cart_goods_del.png" alt="">\n                                    <em></em>\n                                </a>\n                            </div>')}}else 0==JSON.parse(e).code&&(console.log(1),i='<div class="empty_box">\n                        <img src="../images/offline.gif" alt="">\n                        <p>购物车还是空的呢，快去采购吧~<br>或者登录查看之前加入的商品。</p>\n                        <a href="./index.html">去逛逛</a>\n                    </div>');a.box.innerHTML=i})}}]),e}();new LoadGoods;var Delproduct=function(){function e(){_classCallCheck(this,e),this.url="../lib/interface/delwq.php",this.box=document.querySelector(".cart_show .goods_list"),this.init()}return _createClass(e,[{key:"init",value:function(){var a=this;this.box.addEventListener("click",function(e){var t=e||window.event,n=t.target||t.srcElement;"cart_goods_del"==n.parentElement.className&&(n.parentElement.parentElement.remove(),ajaxGet(a.url,function(e){console.log(e)},{id:n.parentElement.parentElement.getAttribute("data-goodsId")}))})}}]),e}();new Delproduct;var Updatenum=function(){function e(){_classCallCheck(this,e),this.url="../lib/interface/delwq.php",this.box=document.querySelector(".cart_show .goods_list"),this.inputArr=document.querySelectorAll("cart_goods_num input"),this.init()}return _createClass(e,[{key:"init",value:function(){var a=this;this.box.addEventListener("click",function(e){var t=e||window.event,n=t.target||t.srcElement;"add_goods_num"==n.className&&a.changeValue(n.parentElement,"add"),"reduce_goods_num"==n.className&&a.changeValue(n.parentElement,"reduce")})}},{key:"changeValue",value:function(t,e){"add"==e?(t.children[1].value++,ajaxGet("../lib/interface/updatewq.php",function(e){t.nextElementSibling.innerHTML=(Number(t.nextElementSibling.innerHTML)+Number(t.previousElementSibling.innerHTML)).toFixed(2)},{id:t.parentElement.getAttribute("data-goodsId"),type:"add"})):"reduce"==e&&(1==t.children[1].value?t.children[1].value=1:(t.children[1].value--,ajaxGet("../lib/interface/updatewq.php",function(e){t.nextElementSibling.innerHTML=(Number(t.nextElementSibling.innerHTML)-Number(t.previousElementSibling.innerHTML)).toFixed(2)},{id:t.parentElement.getAttribute("data-goodsId"),type:"cut"})))}}]),e}();new Updatenum;var ProSelect=function(){function e(){_classCallCheck(this,e),this.flag=1,this.box=document.querySelector(".cart_show .goods_list"),this.selectAll=document.querySelectorAll(".pro_select_all"),this.total=document.querySelector("#pay_tools_bar .cart_total span"),this.init()}return _createClass(e,[{key:"init",value:function(){for(var a=this,e=0;e<this.selectAll.length;e++)this.selectAll[e].onclick=function(){a.changeAll()};this.box.addEventListener("click",function(e){var t=e||window.event,n=t.target||t.srcElement;-1!=n.parentElement.className.indexOf("pro_select_none")&&$(n.parentElement).toggleClass("pro_select"),-1!=n.parentElement.parentElement.className.indexOf("pro_select_none")&&$(n.parentElement.parentElement).toggleClass("pro_select"),a.calculation()})}},{key:"changeAll",value:function(){1==this.flag?($(".pro_select_none").addClass("pro_select"),this.flag=2):2==this.flag&&($(".pro_select_none").removeClass("pro_select"),this.flag=1),this.calculation()}},{key:"calculation",value:function(){for(var e=document.querySelectorAll(".goods_list .pro_select"),t=0,n=0;n<e.length;n++)t+=Number(e[n].parentElement.lastElementChild.previousElementSibling.innerHTML);this.total.innerHTML=t.toFixed(2)}}]),e}();new ProSelect;var SetPaybar=function(){function e(){_classCallCheck(this,e),this.bar=document.getElementById("pay_tools_bar"),this.height=this.bar.offsetTop,this.init(),this.display()}return _createClass(e,[{key:"init",value:function(){var e=this;document.onscroll=function(){e.display()}}},{key:"display",value:function(){var e=this;document.documentElement.scrollTop+document.documentElement.clientHeight<e.height?e.bar.className="paybarpos1":document.documentElement.scrollTop>e.height?e.bar.className="paybarpos3":e.bar.className="paybarpos2"}}]),e}();window.onload=function(){new SetPaybar};var Getuser=function(){function e(){_classCallCheck(this,e),this.user=document.querySelector(".hd_topbar_user a"),this.init()}return _createClass(e,[{key:"init",value:function(){this.user.innerHTML=getCookie("username")}}]),e}();new Getuser;